------------------------UPDATE TABLE-----------------------------------

--NEXT DATA TRANSFORMATION   // UPDATE CRAD AND TRANSACTIONS TABLE
/*
 CONVERT 2021 TXN_YEAR TO 2022
 CONVERT 2020 TXN_YEAR TO 2021
 CONVERT 2018 TXN_YEAR TO 2020
 CONVERT 2017 TXN_YEAR TO 2019
 CONVERT 2016 TXN_YEAR TO 2018
*/

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2021;

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2020;

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2019;

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2018;

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2017;

UPDATE TRANSACTIONS 
SET DATE=DATEADD(YEAR,1,DATE)
WHERE YEAR(DATE)=2016;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2021;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2020;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2019;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2018;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2017;

UPDATE CARD 
SET ISSUED=DATEADD(YEAR,1,ISSUED)
WHERE YEAR(ISSUED)=2016;

--NEXT DATA TRANSFORMATION
/*
 CONVERT 2021 TXN_YEAR TO 2022
 CONVERT 2020 TXN_YEAR TO 2021
 CONVERT 2018 TXN_YEAR TO 2020
 CONVERT 2017 TXN_YEAR TO 2019
 CONVERT 2016 TXN_YEAR TO 2018
*/

SELECT YEAR(DATE) AS TXN_YEAR, COUNT(*) AS TOT_TXNS
FROM TRANSACTIONS
WHERE BANK IS NULL
GROUP BY 1
ORDER BY 2 DESC;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2022';
UPDATE TRANSACTIONS
SET BANK = 'SKY Bank' WHERE BANK IS NULL AND YEAR(DATE) = 2022;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2021';
UPDATE TRANSACTIONS
SET BANK = 'DBS BANK' WHERE BANK IS NULL AND YEAR(DATE) = 2021;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = 2020;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = 2019;
UPDATE TRANSACTIONS
SET BANK = 'NORTHERN BANK' WHERE BANK IS NULL AND YEAR(DATE) = 2019;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2018';
UPDATE TRANSACTIONS
SET BANK = 'SOUTHERN BANK' WHERE BANK IS NULL AND YEAR(DATE) = 2018;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2017';
UPDATE TRANSACTIONS
SET BANK = 'ADB BANK' WHERE BANK IS NULL AND YEAR(DATE) = 2017;

--------------ADDING AGE COLUMN TO THE CLIENT TABLE--------------------------------------

ALTER TABLE CLIENT
ADD COLUMN AGE INT;

SELECT MAX(DATE) FROM TRANSACTIONS;

UPDATE CLIENT
SET AGE = DATEDIFF('YEAR',BIRTH_DATE,'2022-12-19');